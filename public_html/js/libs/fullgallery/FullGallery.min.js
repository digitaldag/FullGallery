/* FullGallery v0.3 Responsive multi-Gallery with thumbinals, customizable transiction and content slideshow License: This work is licensed under the Creative Commons Attribution 4.0 International License. To view a copy of this license, visit http://creativecommons.org/licenses/by/4.0/ or send a letter to Creative Commons, 444 Castro Street, Suite 900, Mountain View, California, 94041, USA. Contacts: digitald(at)big-d-web(dot)com */
(function(f){var u=[];var b={};var e=[{images:[],status:null,animation:"fade",time:6000,autoplay:false,mini:false,buttons:false,resumePlay:true,preload:true,countdown:{active:false,style:{start:"_0",end:"_100"}},callback:{init:function(){},animationStart:function(){},animationEnd:function(){},play:function(){},stop:function(){},tabFocus:function(){},tabBlur:function(){}},debug:false,prev:null,next:null,actual:null,total:null,totalImages:0,loaded:0,base:null,started:0,orientation:null,ratio:null}];var c=new Array();var a=new Array();var g=new Array();var C=new Array();var m={fade:{forward:{before:{actual:{zIndex:-2,display:"block",opacity:"1.0"},next:{zIndex:-1,display:"block",opacity:"0.0"}},actualImageTo:null,delay:0,nextImageTo:{css:{display:"block",opacity:"1.0"},time:1000,method:"linear"},after:{actual:{zIndex:-3,display:"none",opacity:"0.0"},next:{zIndex:-1,display:"block"}}},previous:{before:{actual:{zIndex:-2,display:"block",opacity:"1.0"},next:{zIndex:-1,display:"block",opacity:"0.0"}},actualImageTo:null,delay:0,nextImageTo:{css:{display:"block",opacity:"1.0"},time:1000,method:"linear"},after:{actual:{zIndex:-3,display:"none",opacity:"0.0"},next:{zIndex:-1,display:"block"}}},sync:false,callbacks:{before:function(){},after:function(){}}},slide:{forward:{before:{actual:{zIndex:1,display:"block",top:0,left:0},next:{zIndex:2,display:"block",top:0,left:"100%"}},actualImageTo:{css:{left:"-100%"},time:1200,method:"easeInOutExpo"},delay:0,nextImageTo:{css:{left:"0"},time:1000,method:"easeInOutExpo"},after:{actual:{zIndex:1,display:"none",top:0,left:"100%"},next:{zIndex:1,display:"block",top:0,left:0}}},previous:{before:{actual:{zIndex:1,display:"block",top:0,left:0},next:{zIndex:2,display:"block",top:0,left:"-100%"}},actualImageTo:{css:{left:"100%"},time:1200,method:"easeInOutExpo"},delay:0,nextImageTo:{css:{left:"0"},time:1000,method:"easeInOutExpo"},after:{actual:{zIndex:1,display:"none",top:0,left:"-100%"},next:{zIndex:1,display:"block",top:0,left:0}}},sync:true,callbacks:{before:function(){},after:function(){}}}};f.fn.FullGallery=function(){argL=arguments.length;var D=this;var F=false;var E=f(this).attr("id");E=(E==""||E==undefined)?"FG"+Math.round(Math.random()*10000000):E;f(this).attr({id:E});if(argL==0){e[E]=e[0]}else{if(argL==1&&typeof arguments[0]=="object"){opt=arguments[0]}else{if(argL==2&&arguments[0]=="animations"&&typeof arguments[1]=="object"){m=f.extend(arguments[1],m)}else{if(argL==2&&typeof arguments[0]=="string"&&(typeof arguments[1]=="object"||typeof arguments[1]=="string")){opt=arguments[0];optv=arguments[1]}else{if(argL==1&&typeof arguments[0]=="string"){switch(arguments[0]){case"play":F=A;break;case"stop":F=t;break;case"next":F=q;break;case"prev":F=p;break;case"resize":F=B;break}}else{if(argL==1&&typeof arguments[0]=="number"){F=parseInt(arguments[0]*1);if(e[E].images[F]!=undefined&&F!=e[E].actual){clearTimeout(c[E]);e[E].actual=e[E].actual;e[E].prev=(F<0)?e[E].total:F;e[E].next=F;effect=(e[E].next>e[E].actual)?"n":"p";y(E,effect)}}}}}}}if(F){if(typeof F=="function"){F(E)}}else{if(typeof opt=="object"){if(typeof e[E]=="object"){e[E]=f.extend({},e[E],opt)}else{e[E]=f.extend({},e[0],opt)}}if(typeof opt=="string"){e[E][opt]=optv}e[E].base=this;if(e[E].started==0){v(E)}e[E].started=1}};var v=function(D){if(typeof document.hidden!=="undefined"){b.visibilityValue="hidden";b.visibilityChange="visibilitychange"}else{if(typeof document.mozHidden!=="undefined"){b.visibilityValue="mozHidden";b.visibilityChange="mozvisibilitychange"}else{if(typeof document.msHidden!=="undefined"){b.visibilityValue="msHidden";b.visibilityChange="msvisibilitychange"}else{if(typeof document.webkitHidden!=="undefined"){b.visibilityValue="webkitHidden";b.visibilityChange="webkitvisibilitychange"}}}}document.addEventListener(b.visibilityChange,function(){k(D)},false);C[D]=e[D].base;C[D]="#"+C[D].attr("id")+" ";if(e[D].images.length==0){elements=0;f(e[D].base).children("ul").children("li").each(function(){url=f(this).css("background-image").replace(/url\(/g,"");url=url.replace(/\)/g,"");e[D].images[elements]={url:url.replace(/"/g,""),content:f(this).html()};elements++})}f(e[D].base).empty();switch(e[D].mini){case"thumbnails":thumbs_class="FG_mini FG_thumb_list";break;case"numbers":thumbs_class="FG_mini FG_number_list";break;default:thumbs_class="FG_mini FG_button_list";break}buttons="";if(e[D].buttons){buttons='<ul class="FG_buttons"><li class="prev"></li><li class="next"></li></ul>'}countdown="";if(e[D].countdown.active){countdown='<div class="FG_countdown"><div class="_0"></div></div>'}thumbs='<ul class="'+thumbs_class+'">';for(i=0;i<e[D].images.length;i++){z=-3;d="none";s="";if(i==0){z=-1;d="block";s="FG_thumb_list_actual"}if(e[D].images[i].type=="video"){loop=(e[D].images[i].loop)?"loop":"";controls=(e[D].images[i].controls)?"controls":"";autoplay=(e[D].images[i].autoplay)?"autoplay":"";video='<video class="FG_video" id="'+D+"_video_"+i+'" image="'+i+'" base="'+D+'" '+autoplay+" "+loop+" "+controls+">";sources=e[D].images[i].url.split(";");for(i=0;i<sources.length;i++){source=sources[i].split("|");if(source.length==2){video+='<source src="'+source[0]+'" type="'+source[1]+'">'}else{video+='<source src="'+sources[i]+'">'}}video+="</video>";f(e[D].base).append('<div class="FG_image" image="'+i+'" style="z-index:'+z+";display:"+d+';">'+video+((e[D].images[i].content==undefined)?"":e[D].images[i].content)+"</div>")}else{if(e[D].images[i].type=="youtube"){url=e[D].images[i].url;if(url.indexOf("watch")>=0){url=url.match(/v=(.*)/);url=url[1];url=url.split("&");url=url[0]}else{if(url.indexOf("embed")>=0){url=url.match(/\/embed\/(.*)[\?]*/);url=url[1];url=url.split("&");url=url[0]}}e[D].images[i].url=url;loop=(e[D].images[i].loop)?"1":"0";controls=(e[D].images[i].controls)?"1":"0";autoplay=(e[D].images[i].autoplay)?"1":"0";info=(e[D].images[i].info)?"1":"0";video='<iframe class="FG_video" id="'+D+"_video_"+i+'" image="'+i+'" base="'+D+'" type="text/html" src="//www.youtube.com/embed/'+url+"?autoplay="+autoplay+"&loop="+loop+"&controls="+controls+"&showinfo="+info+'" frameborder="0" h="'+e[D].images[i].height+'" w="'+e[D].images[i].width+'" allowfullscreen>';f(e[D].base).append('<div class="FG_image" image="'+i+'" style="z-index:'+z+";display:"+d+';">'+video+((e[D].images[i].content==undefined)?"":e[D].images[i].content)+"</div>")}else{if(e[D].preload&&e[D].autoplay){f("<img/>").attr("src",e[D].images[i].url).load(function(){f(this).remove();j("Preload",D);e[D].loaded++;n(D)})}e[D].totalImages++;f(e[D].base).append('<div class="FG_image" image="'+i+'" style="z-index:'+z+";background-image:url("+e[D].images[i].url+");display:"+d+';">'+((e[D].images[i].content==undefined)?"":e[D].images[i].content)+"</div>")}}if(e[D].mini!=null){switch(e[D].mini){case"thumbnails":url=(e[D].images[i].type=="video")?"":e[D].images[i].url;if(e[D].images[i].type=="video"){video=document.getElementById(D+"_video_"+i);video.addEventListener("loadeddata",function(){video.currentTime=10;l(this)},false);s+=" FG_thumb_video"}else{if(e[D].images[i].type=="youtube"){url="http://img.youtube.com/vi/"+e[D].images[i].url+"/1.jpg";s+=" FG_thumb_video"}}thumbs+='<li class="FG_thumb_image '+s+'" image="'+(i)+'" style="background-image:url('+url+');background-size:cover;background-position: center center;"></li>';break;case"numbers":thumbs+='<li class="FG_thumb_number '+s+'" image="'+(i)+'" >'+(i+1)+"</li>";break;default:thumbs+='<li class="FG_thumb_button '+s+'" image="'+(i)+'"></li>';break}}}thumbs+="</ul>";append=((e[D].buttons)?buttons:"")+((e[D].mini!==false)?thumbs:"")+((e[D].countdown.active!==false)?countdown:"");f(e[D].base).prepend(append);f(C[D]+" > ul.FG_buttons > li.prev").click(function(){f(e[D].base).FullGallery("prev")});f(C[D]+" > ul.FG_buttons > li.next").click(function(){f(e[D].base).FullGallery("next")});f(C[D]+" > ul.FG_mini > li").click(function(){if(!f(C[D]+" > .FG_image").is(":animated")){j("No animation, start animating",D);img=f(this).attr("image")*1;img=(img>=e[D].images.length)?0:img;img=(img<0)?e[D].images.length-1:img;f(e[D].base).FullGallery(img)}});e[D].actual=0;e[D].total=i-1;e[D].prev=i-1;e[D].next=1;j(e[D],D);f(e[D].base).FullGallery("resize");f(window).resize(function(){f(e[D].base).FullGallery("resize")});if(e[D].autoplay){j("Autoplay",D);if(!e[D].preload){j("No preload",D);e[D].status=1;x(D);c[D]=setTimeout(function(){A(D)},e[D].time)}}if(typeof e[D].callback.init=="function"){e[D].callback.init()}};var t=function(D){e[D].status=0;clearTimeout(c[D]);if(typeof e[D].callback.stop=="function"){e[D].callback.stop()}};var A=function(D){e[D].status=1;if(typeof e[D].callback.play=="function"){e[D].callback.play()}y(D,e[D].animation,"n")};var q=function(D){if(!f(C[D]+" > .FG_image").is(":animated")){clearTimeout(c[D]);y(D,"n")}};var p=function(D){if(!f(C[D]+" > .FG_image").is(":animated")){clearTimeout(c[D]);y(D,"p")}};var y=function(G,F){if(e[G].total>1){if(typeof e[G].callback.animationStart=="function"){e[G].callback.animationStart()}switch(F){case"p":effect="previous";break;default:effect="forward";break}var E=m[e[G].animation][effect];var D=m[e[G].animation];if(F=="p"){a[G]=e[G].actual;g[G]=e[G].prev;e[G].actual=e[G].prev;e[G].prev=(e[G].actual-1<0)?e[G].total:e[G].actual-1;e[G].next=(e[G].actual+1>e[G].total)?0:e[G].actual+1}else{a[G]=e[G].actual;g[G]=e[G].next;e[G].actual=e[G].next;e[G].prev=(e[G].actual-1<0)?e[G].total:e[G].actual-1;e[G].next=(e[G].actual+1>e[G].total)?0:e[G].actual+1}j(e[G].prev+" < "+e[G].actual+" > "+e[G].next,G);if(E.before.actual!=null){f(e[G].base).children('div.FG_image[image="'+a[G]+'"]').css(E.before.actual);j("Before set actual",G);if(typeof D.callbacks.before=="function"){D.callbacks.before("actual",a[G])}B(G)}if(E.before.next!=null){f(e[G].base).children('div.FG_image[image="'+g[G]+'"]').css(E.before.next);j("Before set next",G);if(typeof D.callbacks.before=="function"){D.callbacks.before("next",g[G])}B(G)}if(E.actualImageTo!=null){j("Actual animation start",G);f(e[G].base).children('div.FG_image[image="'+a[G]+'"]').animate(E.actualImageTo.css,E.actualImageTo.time,E.actualImageTo.method,function(){if(!D.sync&&E.nextImageTo!=null){j("Sync false",G);j("Next animation start",G);f(e[G].base).children('div.FG_image[image="'+g[G]+'"]').animate(E.nextImageTo.css,E.nextImageTo.time,E.nextImageTo.method,function(){j("After set acutal",G);f(e[G].base).children('div.FG_image[image="'+a[G]+'"]').css(E.after.actual);if(typeof D.callbacks.after=="function"){D.callbacks.after("actual",a[G])}j("After set next",G);f(e[G].base).children('div.FG_image[image="'+g[G]+'"]').css(E.after.next);if(typeof D.callbacks.after=="function"){D.callbacks.after("next",g[G])}});j("Next animation end",G)}else{j("Sync true",G);j("After set acutal",G);f(e[G].base).children('div.FG_image[image="'+a[G]+'"]').css(E.after.actual);if(typeof D.callbacks.after=="function"){D.callbacks.after("actual",a[G])}}});j("Actual animation end",G)}if(E.nextImageTo!=null){j("Sync false",G);j("Next animation start",G);if(E.delay>0){f(e[G].base).children('div.FG_image[image="'+g[G]+'"]').delay(E.delay).animate(E.nextImageTo.css,E.nextImageTo.time,E.nextImageTo.method,function(){if(!D.sync){j("After set acutal",G);f(e[G].base).children('div.FG_image[image="'+a[G]+'"]').css(E.after.actual);if(typeof D.callbacks.after=="function"){D.callbacks.after("actual",a[G])}}j("After set next",G);f(e[G].base).children('div.FG_image[image="'+g[G]+'"]').css(E.after.next);if(typeof D.callbacks.after=="function"){D.callbacks.after("next",g[G])}});j("Next animation end",G);f(e[G].base).children("div.FG_image").removeClass("actual");f(e[G].base).children('div.FG_image[image="'+g[G]+'"]').addClass("actual")}else{f(e[G].base).children('div.FG_image[image="'+g[G]+'"]').animate(E.nextImageTo.css,E.nextImageTo.time,E.nextImageTo.method,function(){if(!D.sync){j("After set acutal",G);f(e[G].base).children('div.FG_image[image="'+a[G]+'"]').css(E.after.actual);if(typeof D.callbacks.after=="function"){D.callbacks.after("actual",a[G])}}j("After set next",G);f(e[G].base).children('div.FG_image[image="'+g[G]+'"]').css(E.after.next);if(typeof D.callbacks.after=="function"){D.callbacks.after("next",g[G])}});j("Next animation end",G);f(e[G].base).children("div.FG_image").removeClass("actual");f(e[G].base).children('div.FG_image[image="'+g[G]+'"]').addClass("actual")}}if(typeof jQuery.ui!=="undefined"){time=(E.actualImageTo!=null&&E.nextImageTo!=null)?E.actualImageTo.time*1+E.nextImageTo.time*1:1000;f(e[G].base).children(".FG_mini").children("li").removeClass("FG_thumb_list_actual",time);f(e[G].base).children(".FG_mini").children('li[image="'+g[G]+'"]').addClass("FG_thumb_list_actual",time)}else{f(e[G].base).children(".FG_mini").children("li").removeClass("FG_thumb_list_actual");f(e[G].base).children(".FG_mini").children('li[image="'+g[G]+'"]').addClass("FG_thumb_list_actual")}if(e[G].status==1){c[G]=setTimeout(function(){y(G,"n")},e[G].time)}if(typeof e[G].callback.animationEnd=="function"){e[G].callback.animationEnd()}if(f(e[G].base).children('div.FG_image[image="'+g[G]+'"]').children("video").length>0){videoId=f(e[G].base).children('div.FG_image[image="'+g[G]+'"]').children("video").attr("id");document.getElementById(videoId).play()}x(G)}};var j=function(D,E){if(e[E].debug){console.log(D)}};var k=function(D){if(e[D].status!=null){if(document[b.visibilityValue]&&e[D].status==1){j("Visibility change HIDE",D);f(e[D].base).FullGallery("stop");if(typeof e[D].callback.tabBlur=="function"){e[D].callback.tabBlur()}}else{if(e[D].status==0&&e[D].resumePlay==true){j("Visibility change SHOW",D);f(e[D].base).FullGallery("play");if(typeof e[D].callback.tabFocus=="function"){e[D].callback.tabFocus()}}}}};var x=function(D){if(e[D].countdown.active&&e[D].autoplay&&e[D].status==1){if(typeof jQuery.ui!=="undefined"){if(typeof e[D].countdown.style.start=="string"){f(e[D].base).children(".FG_countdown").children("div").addClass(e[D].countdown.style.end,e[D].time,function(){f(this).removeClass(e[D].countdown.style.end)})}else{if(typeof e[D].countdown.style.start=="object"){f(e[D].base).children(".FG_countdown").children("div").animate(e[D].countdown.style.end,e[D].time,function(){f(this).css(e[D].countdown.style.start)})}else{f(e[D].base).children(".FG_countdown").children("div").addClass("_100",e[D].time,function(){f(this).removeClass("_100")})}}}else{f(e[D].base).children(".FG_countdown").children("div").animate(e[D].countdown.style.end,e[D].time,function(){f(this).css(e[D].countdown.style.start)})}}};var n=function(D){j(" ",D);if(e[D].totalImages==e[D].loaded){j("Play",D);A(D)}};var B=function(D){f(e[D].base).children("div.FG_image").children("video").each(function(){h=f(e[D].base).height();w=f(e[D].base).width();o=(w>h)?"o":"v";r=(o!="o")?w/h:h/w;e[D].orientation=o;e[D].ratio=r;if(o=="o"){vH="auto";vW="100%";f(this).attr({height:vH,width:vW});if(f(this).height()<=h){vH="100%";vW="auto"}}else{vH="100%";vW="auto";f(this).attr({height:vH,width:vW});if(f(this).width()<=w){vH="auto";vW="100%"}}f(this).attr({height:vH,width:vW})});f(e[D].base).children("div.FG_image").children("iframe").each(function(){hC=f(e[D].base).height();wC=f(e[D].base).width();oC=(wC>hC)?"o":"v";rC=(oC!="o")?wC/hC:hC/wC;e[D].orientation=oC;e[D].ratio=rC;h=f(this).attr("h");w=f(this).attr("w");o=(w>h)?"o":"v";r=(oC!="o")?w/h:h/w;if(oC=="o"){vH=wC*r;vW=wC;f(this).attr({height:vH,width:vW});if(f(this).height()<=hC){r=w/h;vH=hC;vW=hC*r}}else{vH=hC;vW=hC*r;f(this).attr({height:vH,width:vW});if(f(this).width()<=wC){vH=wC*r;vW=wC}}f(this).attr({height:vH,width:vW})})};var l=function(D){thumb=f(D).attr("image");id=f(D).attr("base");canvas=document.createElement("canvas");canvas.width=D.videoWidth;canvas.height=D.videoHeight;context=canvas.getContext("2d");context.drawImage(D,0,0,D.videoWidth,D.videoHeight);dataURL=canvas.toDataURL();f(e[id].base).children("ul").children('li[image="'+thumb+'"]').css({background:"url("+dataURL+")","background-size":"cover"})}})(jQuery);